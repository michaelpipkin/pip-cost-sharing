<div class="container pt-3 mb-2">
  <div class="page-header">
    <div></div>
    <h3>Help Topics</h3>
    <div></div>
  </div>
  <mat-accordion>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title><h5>Groups</h5></mat-panel-title>
      </mat-expansion-panel-header>
      <p>
        In order to use this app, you must be a member of at least one group. If
        you received a group join code, click the Join Group button. Enter the
        group code, as well as your display name for the group. You can have a
        different display name for each group you are in.
      </p>
      <p>
        If you need to create a new group, click the Create New Group button.
        Enter the group name, as well as your display name for the group. After
        saving, the group join code will be generated and displayed. Share this
        code with people you want to invite to the group. You will automatically
        be made an admin for any group you create.
      </p>
      <p>
        You can manage all groups for which you are a group admin by clicking
        the Manage Groups button. From here, you can change the group name, or
        make it inactive. Inactive groups won't show up in the Select Group
        drowndown list on the groups page.
      </p>
    </mat-expansion-panel>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title><h5>Members</h5></mat-panel-title>
      </mat-expansion-panel-header>
      <p>
        Group members can click on their own name in the members list to update
        their display name and email address for the group. By default, when
        joining or creating a group, your email address is set to your login
        email address. However, this can be updated individually for each group
        without affecting your login email address.
      </p>
      <p>
        Group admins can add placeholder members by clicking the Add Member
        button. Enter the display name and email address for the new member. If
        someone registers for the app with the same email address and then joins
        the group, the placeholder member will be automatically replaced with
        the new member.
      </p>
      <p>
        Group admins can edit all group members, change their active status, and
        give or remove admin rights to other members. An admin may not remove
        their own admin rights - another admin must peform that update.
      </p>
      <p>
        Group members can only be removed if they don't have any expenses/splits
        assigned to them. Group members who are made inactive will no longer
        show up in the dropdown list when creating a new expense.
      </p>
    </mat-expansion-panel>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title><h5>Categories</h5></mat-panel-title>
      </mat-expansion-panel-header>
      <p>
        A default category is automatically created when a new group is created.
        Any group admin can create additional categories.
      </p>
      <p>
        Categories can only be deleted if they don't have any expenses/splits
        assigned to them. Categories that are made inactive will no longer show
        up in the dropdown list when creating a new expense. Only group admins
        can edit or delete categories, or change their active status.
      </p>
      <p>
        If your group does not have any need for categorizing expenses, you can
        simply use the default category for all expenses. As long as your group
        only has one category, it will be selected automatically for you when
        you create a new expense.
      </p>
    </mat-expansion-panel>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title><h5>Expenses</h5></mat-panel-title>
      </mat-expansion-panel-header>
      <p>
        By default, the expenses page shows all unpaid expenses. You can use the
        filter dropdowns to filter expenses by payee, category, or both. You can
        also toggle off Unpaid only to view all expenses. Clicking the Date
        header will toggle sorting the table in ascending or descending date
        order.
      </p>
      <p>
        Click the Splits arrow on any row to expand the split detail for that
        expense. You can click the paid icon on a split row to mark that
        specific split paid or unpaid.
      </p>
      <p>
        Click the Add New Expense button to create a new expense for the group.
      </p>
      <p>
        Click on an expense row to edit the expense details. Please note that
        editing an expense will mark all splits unpaid. When viewing an existing
        expense, you can view the receipt, if one exists.
      </p>
    </mat-expansion-panel>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title><h5>Add & Edit Expenses</h5></mat-panel-title>
      </mat-expansion-panel-header>
      <p>Enter or edit expense details with this form.</p>
      <p>
        With your cursor in the date field, you can use the + and - keys to
        adjust the date up and down by one day. Hitting 't' will set the date to
        today, 'm' or 'y' will set the date to the first day of the month or
        year of the date currently in the field, respectively.
      </p>
      <p>
        The Proportional Amount field is for items like tax and tip that should
        be split proportional to the amount for which each member is
        responsible. The evenly shared remainder and the allocated split amount
        for each member will update automatically as you enter/update the total
        amount, proportional amount, and individual member amounts. The
        proportional amount is only available when splitting by amount, not
        percentage.
      </p>
      <p>
        Click the Add New Split button to add a single split line to the
        expense. By default, an expense is split evenly between all listed
        members. Click the Split by button to alternate between splitting the
        expense by dollar amount or by percentage.
      </p>
      <p>
        If you are splitting by amount, you can enter the amount in the Member
        Amount field that the member is individually responsible for and should
        not be split. Click the Add All Members button to automatically insert a
        split line for each active group member not already listed in the splits
        table. The form will automatically update the allocated amounts for each
        member as you change the total amount, proportional amount, or
        individual amounts for each member.
      </p>
      <p>
        If you are splitting by percentage, the form will automatically adjust
        the final member's percentage so that the total will always be 100%.
      </p>
      <p>
        You can perform basic arithmetic directly in any amount input field, but
        not percentage fields. (i.e. entering 3*6-2 in the total amount field
        will evaluate to 16.00)
      </p>
      <p>
        The form also allows you to upload a supporting receipt for the expense.
        The receipt must be a PDF or an image file, with a maximum size of 5MB.
        Click the Upload receipt button, then select your file. The receipt will
        be saved with the expense.
      </p>
    </mat-expansion-panel>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title><h5>Memorized Expenses</h5></mat-panel-title>
      </mat-expansion-panel-header>
      <p>
        If your group has a regularly reccuring expense, you can create a
        memorized expense on this page. Memorizing an expense saves most of the
        expense details, allowing you to quickly and easily create a new expense
        based on the memorized expense.
      </p>
      <p>
        After creating a memorized expense, it will appear in the table.
        Clicking a row in the table will let you edit or delete the memorized
        expense.
      </p>
      <p>
        Clicking the + on the memorized expense row will create a new expense
        based on the memorized expense.
      </p>
    </mat-expansion-panel>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title
          ><h5>Add & Edit Memorized Expenses</h5></mat-panel-title
        >
      </mat-expansion-panel-header>
      <p>Enter or edit a memorized expense with this form.</p>
      <p>
        The Proportional Amount field is for items like tax and tip that should
        be split proportional to the amount for which each member is
        responsible. The evenly shared remainder and the allocated split amount
        for each member will update automatically as you enter/update the total
        amount, proportional amount, and individual member amounts. The
        proportional amount is only available when splitting by amount, not
        percentage.
      </p>
      <p>
        Click the Add New Split button to add a single split line to the
        expense. By default, an expense is split evenly between all listed
        members. Click the Split by button to alternate between splitting the
        expense by dollar amount or by percentage.
      </p>
      <p>
        If you are splitting by amount, you can enter the amount in the Member
        Amount field that the member is individually responsible for and should
        not be split. Click the Add All Members button to automatically insert a
        split line for each active group member not already listed in the splits
        table. The form will automatically update the allocated amounts for each
        member as you change the total amount, proportional amount, or
        individual amounts for each member.
      </p>
      <p>
        If you are splitting by percentage, the form will automatically adjust
        the final member's percentage so that the total will always be 100%.
      </p>
      <p>
        You can perform basic arithmetic directly in any amount input field, but
        not percentage fields. (i.e. entering 3*6-2 in the total amount field
        will evaluate to 16.00)
      </p>
    </mat-expansion-panel>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title><h5>Summary</h5></mat-panel-title>
      </mat-expansion-panel-header>
      <p>
        Select a group member from the dropdown list to view the total amount
        owed by that member to the other group members, and to that member from
        the other group members. If you wish to see a summary of expenses for a
        specific date range, you can enter the start date, end date, or both.
      </p>
      <p>
        After selecting a group member and optionally entering filter dates, if
        any outstanding expenses are found, you can click on a row in the table
        to see the category breakdown of the expenses owed between the two
        members.
      </p>
      <p>
        Click the paid icon on any row to mark all splits owed between those two
        group members as paid. Please note this action can only be undone by
        viewing the expenses on the expenses page and clicking the paid icon one
        split at a time. Marking expenses paid in this way will create a history
        record of the payment with the amount broken down by category. The
        history of payments can be viewed on the history page.
      </p>
    </mat-expansion-panel>
    <mat-expansion-panel hideToggle>
      <mat-expansion-panel-header>
        <mat-panel-title><h5>History</h5></mat-panel-title>
      </mat-expansion-panel-header>
      <p>
        Select a group member from the dropdown list to view a history of
        payments made to and from that member.
      </p>
      <p>
        Click on any row to view a breakdown of the amounts by category for the
        payment.
      </p>
      <p>
        Group admins may delete history records. Payment history records are
        informational only -- deleting a payment history record does not mark
        the associated expenses as unpaid.
      </p>
    </mat-expansion-panel>
  </mat-accordion>
  <div class="issue-container">
    <h3>Report an Issue</h3>
    <form [formGroup]="issueForm" class="issue-form">
      <mat-form-field appearance="fill" subscriptSizing="dynamic">
        <mat-label>Title</mat-label>
        <input matInput formControlName="title" />
        @if (f.title.errors?.required) {
          <mat-error> *Required </mat-error>
        }
      </mat-form-field>
      <mat-form-field appearance="fill" subscriptSizing="dynamic">
        <mat-label>Your email address</mat-label>
        <input matInput formControlName="email" />
        <mat-hint
          >Optional - provide your email address if you would like the developer
          to contact you regarding the issue</mat-hint
        >
        @if (f.email.errors?.email) {
          <mat-error> *Invalid email address </mat-error>
        }
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Description</mat-label>
        <textarea
          matInput
          formControlName="body"
          maxlength="5000"
          rows="5"
        ></textarea>
        @if (f.body.errors?.required) {
          <mat-error> *Required </mat-error>
        }
        <mat-hint align="end">{{ f.body.value?.length || 0 }}/5000</mat-hint>
      </mat-form-field>
      <div class="buttons">
        <button
          mat-raised-button
          class="btn-secondary"
          type="submit"
          defaultButton
          [disabled]="!issueForm.valid || issueForm.disabled"
          (click)="onSubmit()"
        >
          Submit
        </button>
        <button
          mat-stroked-button
          type="button"
          [disabled]="issueForm.pristine"
          (click)="clearForm()"
        >
          Clear
        </button>
      </div>
    </form>
  </div>
</div>
