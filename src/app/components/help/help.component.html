<div class="container pt-3" data-testid="help-container">
  <div class="page-header" data-testid="help-page-header">
    <div></div>
    <h3 data-testid="help-page-title">Help Topics</h3>
    <div></div>
  </div>
  <mat-accordion data-testid="help-accordion">
    @for (section of helpSections; track section.id) {
      <mat-expansion-panel hideToggle [attr.data-testid]="'help-panel-' + section.id">
        <mat-expansion-panel-header [attr.data-testid]="'help-panel-header-' + section.id">
          <mat-panel-title
            [attr.data-testid]="'help-panel-title-' + section.id"
            ><h5>{{ section.title }}</h5></mat-panel-title
          >
        </mat-expansion-panel-header>
        @for (paragraph of section.content; track $index) {
          <p [attr.data-testid]="'help-content-' + section.id + '-' + $index">{{ paragraph }}</p>
        }
      </mat-expansion-panel>
    }
  </mat-accordion>
  <div class="issue-container" data-testid="report-issue-container">
    <h3 data-testid="report-issue-title">Report an Issue</h3>
    <form [formGroup]="issueForm" class="issue-form" data-testid="report-issue-form" aria-label="Report an issue form">
      <mat-form-field appearance="fill" subscriptSizing="dynamic">
        <mat-label>Title</mat-label>
        <input matInput formControlName="title" />
        @if (f.title.errors?.required) {
          <mat-error> *Required </mat-error>
        }
      </mat-form-field>
      <mat-form-field appearance="fill" subscriptSizing="dynamic">
        <mat-label>Your email address</mat-label>
        <input matInput formControlName="email" />
        <mat-hint
          >Optional - provide your email address if you would like the developer
          to contact you regarding the issue</mat-hint
        >
        @if (f.email.errors?.email) {
          <mat-error> *Invalid email address </mat-error>
        }
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Description</mat-label>
        <textarea
          matInput
          formControlName="body"
          maxlength="2000"
          rows="5"
        ></textarea>
        @if (f.body.errors?.required) {
          <mat-error> *Required </mat-error>
        }
        <mat-hint align="end">{{ f.body.value?.length || 0 }}/2000</mat-hint>
      </mat-form-field>
      <div class="buttons">
        <button
          mat-raised-button
          class="btn-secondary"
          type="submit"
          defaultButton
          [disabled]="!issueForm.valid || issueForm.disabled"
          (click)="onSubmit()"
        >
          Submit
        </button>
        <button
          mat-stroked-button
          type="button"
          [disabled]="issueForm.pristine"
          (click)="clearForm()"
        >
          Clear
        </button>
      </div>
    </form>
  </div>
</div>
